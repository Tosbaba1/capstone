<div>
  <div>
    <h1>
      Feed
    </h1>
  </div>
</div>

<%= form_with url: insert_post_path, method: :post, local: true do |f| %>
  <%= f.hidden_field :creator_id, value: current_user.id %>       <!-- no longer needed -->
  <%= f.text_area    :content, rows: 3, placeholder: "What's happening?" %>

  <%= f.collection_select :book_id, Book.all, :id, :title,
        prompt: "Attach a book (optional)" %>

  <!-- later: media upload field -->
  <%= f.submit "Post" %>
<% end %>


<hr>

<div class="posts-feed">
  <% @list_of_posts.each do |post| %>
    <div class="post-card">
      <div class="post-header">
        <%= image_tag(post.creator.avatar || 'default_avatar.png', alt: post.creator.name, class: 'avatar') %>
        <div class="post-user-info">
          <strong><%= post.creator.name %></strong>
          <small><%= time_ago_in_words(post.created_at) %> ago</small>
        </div>
      </div>
      <div class="post-body">
        <p><%= post.content %></p>
        <% if post.book %>
          <p class="post-book">
            Reading: <%= link_to post.book.title, book_path(post.book) %>
          </p>
        <% end %>
      </div>
      <div class="post-footer">
        <span><%= pluralize(post.likes_count, 'Like') %></span>
        <span><%= pluralize(post.comments_count, 'Comment') %></span>
      </div>
    </div>
    <hr>
  <% end %>
</div>
